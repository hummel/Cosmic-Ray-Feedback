\section{Numerical Methods}
\label{methods}

\subsection{Initial Setup}
\label{setup}

Using the well-tested $N$-body smoothed particle hydrodynamics code GADGET2 \citep{Springel2005}, we initialise our simulations using the same setup described in \citet{Hummeletal2014}, allowing for a direct comparison of the impact of X-rays versus cosmic rays on the primordial gas.  The simulations were initialise at $z=100$ in a 140 comoving kpc box with periodic boundary conditions. To accelerate structure formation in the simulation box an artificially enhanced normalisation of the power spectrum, $\sigma_8 = 1.4$, was used, but the simulations are otherwise initialised in accordance with a $\Lambda$CDM model of hierarchical structure formation. For a discussion of the validity of this choice, see \citet{StacyGreifBromm2010}. High resolution in these simulations is achieved using as standard hierarchical zoom-in technique, with nested levels of refinement at 40, 30, and 20 kpc (comoving).  Using this technique, the highest resolution SPH particles have a mass $m_{\rm SPH} = 0.015\msun$, yielding a maximum mass resolution $M_{\rm res} \simeq 1.5 N_{\rm neigh} m_{\rm SPH} \lesssim 1\msun$ for the simulation.  Here $N_{\rm neigh} \simeq 32$ is the number of particles used in the SPH smoothing kernel \citep{BateBurkert1997}.

In addition, we also use the same chemistry and cooling network and sink particle method as in \citet{Hummeletal2014}.  Our chemistry network is that described in \citet{Greifetal2009b}, and follows the abundance evolution of $\h$, $\hplus$, $\hminus$, $\htwo$, $\htwo^+$, $\he$, $\heplus$, $\he^{++}$, $\deut$, $\deut^+$, $\hd$ and e$^-$.
